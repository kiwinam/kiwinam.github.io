<!DOCTYPE html>
<html lang="en">
    <head>
        
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-99327236-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-99327236-2');
</script>

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="키위남">
<meta name="description"
    content="[안드로이드] 엑셀 파일 생성, 내보내기
어플리케이션을 만들다 보면 사용자가 저장한 데이터를 가공하여 내보내 주는 기능을 구현할 때가 있습니다.
데이터 가공에 가장 적합한 엑셀 파일을 만들어 공유하는 것을 목표로 포스팅하겠습니다.

1. Result 

2. Step by Step 2-1. Apache POI 2-1-1. 라이브러리 다운로드  안드로이드 (자바) 에서 엑셀 파일을 바로 쓰고 읽고 수정 하는 일련의 작업들을 바로 수행할 수는 없습니다. 이러한 작업을 할 수 있도록 도와주는 라이브러리인 Apache 에서 제공하는 POI 라이브러리를 이용하여 엑셀을 다루도록 하겠습니다." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://kiwinam.com/posts/21/" />


<meta property="og:image" content="https://kiwinam.com/21/21-1.png">



<meta property="og:image" content="https://kiwinam.com/21/21-1.png">



<meta property="og:image" content="https://kiwinam.com/21/21-1.png">



<title>
    
    [안드로이드] 엑셀 파일 생성, 내보내기 :: Kiwinam  — Just code it
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.2f0d18b84270567c723bff340b09ab08db3a7634237cd9667d052eb6b14669b8.css">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="[안드로이드] 엑셀 파일 생성, 내보내기">
<meta itemprop="description" content="안드로이드의 데이터를 엑셀 파일로 어떻게 생성하고, 데이터를 내보낼 수 있는지 알아보겠습니다.">


<meta itemprop="datePublished" content="2017-12-07T10:35:56&#43;09:00" />
<meta itemprop="dateModified" content="2017-12-07T10:35:56&#43;09:00" />
<meta itemprop="wordCount" content="337">



<meta itemprop="keywords" content="ACTION_SEND,Excel,내보내기,생성,안드로이드,엑셀,파일 보내기," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="[안드로이드] 엑셀 파일 생성, 내보내기"/>
<meta name="twitter:description" content="안드로이드의 데이터를 엑셀 파일로 어떻게 생성하고, 데이터를 내보낼 수 있는지 알아보겠습니다."/>



<meta property="article:section" content="Android" />

<meta property="article:published_time" content="2017-12-07 10:35:56 &#43;0900 KST" />







    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">cd /home/kiwinam</span>
            <span class="logo__cursor" style=""></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://kiwinam.com/about">About</a></li><li><a href="https://kiwinam.com/posts">posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>2 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title"><a href="https://kiwinam.com/posts/21/">[안드로이드] 엑셀 파일 생성, 내보내기</a></h1>

            

            <div class="post-content">
                

<hr />

<p>[안드로이드] 엑셀 파일 생성, 내보내기</p>

<hr />

<p><img src="/21/21-1.png" alt="엑셀 로고" /></p>

<p>어플리케이션을 만들다 보면 사용자가 저장한 데이터를 가공하여 내보내 주는 기능을 구현할 때가 있습니다.</p>

<p>데이터 가공에 가장 적합한 엑셀 파일을 만들어 공유하는 것을 목표로 포스팅하겠습니다.</p>

<p><br/></p>

<h3 id="1-result">1. Result</h3>

<p><img src="/21/21-2.jpg" alt="엑셀 결과" /></p>

<p><img src="/21/21-3.jpg" alt="엑셀 결과" /></p>

<p><br/></p>

<p><br/></p>

<h3 id="2-step-by-step">2. Step by Step</h3>

<h4 id="2-1-apache-poi">2-1. Apache POI</h4>

<h4 id="2-1-1-라이브러리-다운로드">2-1-1. 라이브러리 다운로드</h4>

<ul>
<li>안드로이드 (자바) 에서 엑셀 파일을 바로 쓰고 읽고 수정 하는 일련의 작업들을 바로 수행할 수는 없습니다. 이러한 작업을 할 수 있도록 도와주는 라이브러리인 Apache 에서 제공하는 POI 라이브러리를 이용하여 엑셀을 다루도록 하겠습니다.</li>
</ul>

<p><a href="http://poi.apache.org/download.html#POI-3.17" target="_blank"><a href="http://poi.apache.org/download.html#POI-3.17">http://poi.apache.org/download.html#POI-3.17</a></a></p>

<p>위 링크를 클릭해 라이브러리 다운로드 홈페이지로 이동하겠습니다.</p>

<p><img src="/21/21-4.png" alt="poi download" /></p>

<ul>
<li>홈페이지에서 Binary Distribution 을 보면 가장 최근 안정화된 버전을 배포하고 있습니다. poi-bin 파일을 클릭해주세요.</li>
</ul>

<p><br/></p>

<p><img src="/21/21-5.png" alt="apache download" /></p>

<ul>
<li>그럼 위 사진과 같은 페이지가 나오는데 어떤 미러링 사이트를 통해 받을지 정합니다.</li>
</ul>

<p><br/></p>

<p><img src="/21/21-6.png" alt="download" /></p>

<ul>
<li>다운로드 완료 후 압축을 풀면 위와 같은 파일들이 나옵니다. 이제 이 파일을 안드로이드 프로젝트에 적용 시키도록 하겠습니다.</li>
</ul>

<p><br/></p>

<p><br/></p>

<h4 id="2-1-1-안드로이드-스튜디오-라이브러리-적용">2-1-1. 안드로이드 스튜디오 라이브러리 적용</h4>

<ul>
<li>먼저 파일 탐색기를 프로젝트 단으로 봐주세요</li>
</ul>

<p><img src="/21/21-7.jpg" alt="android project" /></p>

<p><br/></p>

<ul>
<li>프로젝트 &gt; app &gt; libs 에 방금 다운로드 받은 POI 라이브러리 파일을 옮겨주세요</li>
</ul>

<p><img src="/21/21-8.jpg" alt="libs" /></p>

<p><img src="/21/21-9.jpg" alt="move the files" /></p>

<p><br/></p>

<ul>
<li><p>간단하게 생성과 쓰기를 해볼거기 때문에 poi-3.17.jar 파일만 옮겼습니다.</p></li>

<li><p>파일을 옮겨지면 안드로이드 스튜디오에서 아래와 같이 라이브러리 파일이 정상적으로 올라온 것을 확인할 수 있습니다.</p></li>
</ul>

<p><img src="/21/21-10.jpg" alt="poi" /></p>

<p><br/></p>

<ul>
<li>아래 사진처럼 poi-3.17.jar 파일을 우클릭 한 다음 &lsquo;Add As Library&rsquo; 를 눌러주시면 POI 라이브러리 적용이 완료됩니다.</li>
</ul>

<p><img src="/21/21-11.jpg" alt="add ad library" /></p>

<p><br/></p>

<p><br/></p>

<h3 id="2-2-엑셀-생성-쓰기">2-2 엑셀 생성, 쓰기</h3>

<pre><code class="language-Java">private void saveExcel(){
    Workbook workbook = new HSSFWorkbook();

    Sheet sheet = workbook.createSheet(); // 새로운 시트 생성

    Row row = sheet.createRow(0); // 새로운 행 생성
    Cell cell;

    cell = row.createCell(0); // 1번 셀 생성
    cell.setCellValue(&quot;이름&quot;); // 1번 셀 값 입력

    cell = row.createCell(1); // 2번 셀 생성
    cell.setCellValue(&quot;나이&quot;); // 2번 셀 값 입력

    for(int i = 0; i &lt; mItems.size() ; i++){ // 데이터 엑셀에 입력
        row = sheet.createRow(i+1);
        cell = row.createCell(0);
        cell.setCellValue(mItems.get(i).getName());
        cell = row.createCell(1);
        cell.setCellValue(mItems.get(i).getAge());
    }

    File xlsFile = new File(getExternalFilesDir(null),&quot;test.xls&quot;);
    try{
        FileOutputStream os = new FileOutputStream(xlsFile);
        workbook.write(os); // 외부 저장소에 엑셀 파일 생성
    }catch (IOException e){
        e.printStackTrace();
    }
    Toast.makeText(getApplicationContext(),xlsFile.getAbsolutePath()+&quot;에 저장되었습니다&quot;,Toast.LENGTH_SHORT).show();
}
</code></pre>

<p><img src="/21/21-12.png" alt="excel result" /></p>

<ul>
<li>제가 입력했던 데이터가 엑셀 파일로 만들어 진 것을 확인 할 수 있습니다.</li>
</ul>

<p><br/></p>

<p><br/></p>

<h3 id="2-3-엑셀-내보내기-action-send">2-3 엑셀 내보내기 (ACTION_SEND)</h3>

<ul>
<li><p>방금 만들어진 엑셀 파일을 내보내보도록 하겠습니다.</p>

<pre><code class="language-java">Uri path = Uri.fromFile(xlsFile);
Intent shareIntent = new Intent(Intent.ACTION_SEND);
shareIntent.setType(&quot;application/excel&quot;);
shareIntent.putExtra(Intent.EXTRA_STREAM,path);
startActivity(Intent.createChooser(shareIntent,&quot;엑셀 내보내기&quot;));
</code></pre></li>
</ul>

<p><img src="/21/21-13.jpg" alt="excel send" /></p>

<p><img src="/21/21-14.jpg" alt="excel kakao" /></p>

<p><br/></p>

<h3 id="3-source-code">3. Source Code</h3>

<p>전체 소스 코드는 <a href="https://github.com/kiwinam/ExcelExample" target="_blank">GitHub </a>에 공유했습니다.</p>

<p><br/></p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://kiwinam.com/tags/action_send">ACTION_SEND</a></span><span class="tag"><a href="https://kiwinam.com/tags/excel">Excel</a></span><span class="tag"><a href="https://kiwinam.com/tags/%EB%82%B4%EB%B3%B4%EB%82%B4%EA%B8%B0">내보내기</a></span><span class="tag"><a href="https://kiwinam.com/tags/%EC%83%9D%EC%84%B1">생성</a></span><span class="tag"><a href="https://kiwinam.com/tags/%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C">안드로이드</a></span><span class="tag"><a href="https://kiwinam.com/tags/%EC%97%91%EC%85%80">엑셀</a></span><span class="tag"><a href="https://kiwinam.com/tags/%ED%8C%8C%EC%9D%BC-%EB%B3%B4%EB%82%B4%EA%B8%B0">파일 보내기</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>337 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2017-12-07 10:35 &#43;0900</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h">Read other posts</span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="https://kiwinam.com/posts/22/">
                                <span class="button__icon">←</span>
                                <span class="button__text">[Mac] OS X 기능, 맥북 화면 녹화하기</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="https://kiwinam.com/posts/19/">
                                <span class="button__text">[안드로이드] - android.content.res.Resources$NotFoundException: String resource ID #0x1</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2019</span>
            
            <span></span>
            <span> <a href="https://kiwinam.com/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.4c3fb12a087ceed4a52cb5d57068a9795c7069617a01ca70f788052ad66e1791779e6c72686e1dc0ca13dc03b0203204b6566bb0dd1ee80de2b7ff4d8fe53db2.js" integrity="sha512-TD&#43;xKgh87tSlLLXVcGipeVxwaWF6Acpw94gFKtZuF5F3nmxyaG4dwMoT3AOwIDIEtlZrsN0e6A3it/9Nj&#43;U9sg=="></script>



    </body>
</html>
